# è§„åˆ™æ¨¡å¼ï¼šruleï¼ˆè§„åˆ™ï¼‰ / globalï¼ˆå…¨å±€ä»£ç†ï¼‰/ directï¼ˆå…¨å±€ç›´è¿ï¼‰
mode: rule

# è®¾ç½®æ—¥å¿—è¾“å‡ºçº§åˆ« (é»˜è®¤çº§åˆ«ï¼šsilentï¼Œå³ä¸è¾“å‡ºä»»ä½•å†…å®¹ï¼Œä»¥é¿å…å› æ—¥å¿—å†…å®¹è¿‡å¤§è€Œå¯¼è‡´ç¨‹åºå†…å­˜æº¢å‡ºï¼‰ã€‚
# 5 ä¸ªçº§åˆ«ï¼šsilent / info / warning / error / debugã€‚çº§åˆ«è¶Šé«˜æ—¥å¿—è¾“å‡ºé‡è¶Šå¤§ï¼Œè¶Šå€¾å‘äºè°ƒè¯•ï¼Œè‹¥éœ€è¦è¯·è‡ªè¡Œå¼€å¯ã€‚
log-level: silent

http:
  # å¼€å¯ MitM åŠŸèƒ½çš„åŸŸååˆ—è¡¨ï¼Œéœ€è¦ç¡®ä¿ä¸Šè¿° CA è¯ä¹¦å·²å—ç³»ç»Ÿä¿¡ä»»
  mitm:
    - api.weibo.cn
  # ä½¿ç”¨ JavaScript è„šæœ¬æ”¹å†™ HTTP(S) è¯·æ±‚
  script:
    - match: ^https:\/\/api\.weibo\.cn\/2\/users\/show\?
      name: fix-vvebo-user-timeline
      type: request
      timeout: 10
    - match: ^https:\/\/api\.weibo\.cn\/2\/statuses\/user_timeline\?
      name: fix-vvebo-user-timeline
      type: request
      timeout: 10
    - match: ^https:\/\/api\.weibo\.cn\/2\/profile\/statuses\/tab\?
      name: fix-vvebo-user-timeline
      type: response
      require-body: true
      timeout: 10
  # HTTP(S) é‡å†™ï¼Œæ”¯æŒ headerã€302ã€307ã€reject å¤šç§ç­–ç•¥
  url-rewrite:
    - ^http://g\.cn http://www.google.com header
    - ^https?://www\.google\.cn https://www.google.com 302

script-providers:
  fix-vvebo-user-timeline:
    url: https://raw.githubusercontent.com/suiyuran/stash/main/scripts/fix-vvebo-user-timeline.js
    interval: 86400

port: 4780
socks-port: 4781
redir-port: 7892
allow-lan: true
external-controller: '0.0.0.0:9090'
secret: ''
dns:
  # æ”¯æŒ UDP / TCP / DoT / DoH åè®®çš„ DNS æœåŠ¡ï¼Œå¯ä»¥æŒ‡æ˜å…·ä½“çš„è¿æ¥ç«¯å£å·ã€‚
  # æ‰€æœ‰ DNS è¯·æ±‚å°†ä¼šç›´æ¥å‘é€åˆ°æœåŠ¡å™¨ï¼Œä¸ç»è¿‡ä»»ä½•ä»£ç†ã€‚
  # Stash ä¼šä½¿ç”¨æœ€å…ˆè·å¾—çš„è§£æè®°å½•å›å¤ DNS è¯·æ±‚
  nameserver:
    # ä¸å»ºè®®é…ç½®è¶…è¿‡ 2 ä¸ª DNS æœåŠ¡å™¨ï¼Œä¼šå¢åŠ ç³»ç»ŸåŠŸè€—
    - tls://223.5.5.5:853
    - https://223.6.6.6/dns-query
    - https://120.53.53.53/dns-query
  # å¯¹éƒ¨åˆ†åŸŸåä½¿ç”¨å•ç‹¬çš„ DNS æœåŠ¡å™¨
  nameserver-policy:
    +.tmall.com: 223.5.5.5
    +.taobao.com: 223.5.5.5
    +.alicdn.com: 223.5.5.5
    +.aliyun.com: 223.5.5.5
    +.alipay.com: 223.5.5.5
    +.alibaba.com: 223.5.5.5
    +.qq.com: 119.29.29.29
    +.tencent.com: 119.29.29.29
    +.weixin.com: 119.29.29.29
    +.qpic.cn: 119.29.29.29
    +.jd.com: 119.29.29.29
    +.bilibili.com: 119.29.29.29
    +.hdslb.com: 119.29.29.29
    +.163.com: 119.29.29.29
    +.126.com: 119.29.29.29
    +.126.net: 119.29.29.29
    +.127.net: 119.29.29.29
    +.netease.com: 119.29.29.29
    +.baidu.com: 223.5.5.5
    +.bdstatic.com: 223.5.5.5
    +.bilivideo.+: 119.29.29.29
    +.iqiyi.com: 119.29.29.29
    +.douyinvod.com: 180.184.1.1
    +.douyin.com: 180.184.1.1
    +.douyincdn.com: 180.184.1.1
    +.douyinpic.com: 180.184.1.1
    +.feishu.cn: 180.184.1.1
  # åœ¨ä»¥ä¸‹åˆ—è¡¨çš„åŸŸåå°†ä¸ä¼šè¢«è§£æä¸º fake ipï¼Œè¿™äº›åŸŸåç›¸å…³çš„è§£æè¯·æ±‚å°†ä¼šè¿”å›å®ƒä»¬çœŸå®çš„ IP åœ°å€
  fake-ip-filter:
    - '*.n.n.srv.nintendo.net'
    - +.stun.playstation.net
    - xbox.*.*.microsoft.com
    - '*.msftncsi.com'
    - '*.msftconnecttest.com'
    - WORKGROUP
    - '*.lan'
    - stun.*.*.*
    - stun.*.*
    - time.windows.com
    - time.nist.gov
    - time.apple.com
    - time.asia.apple.com
    - '*.ntp.org.cn'
    - '*.openwrt.pool.ntp.org'
    - time1.cloud.tencent.com
    - time.ustc.edu.cn
    - pool.ntp.org
    - ntp.ubuntu.com
    - '*.*.xboxlive.com'
    - speedtest.cros.wr.pvp.net
  enable: true
  listen: '127.0.0.1:53'
  ipv6: true
  use-hosts: true
  enhanced-mode: fake-ip
  fallback:
    - 'https://101.101.101.101/dns-query'
    - 'https://public.dns.iij.jp/dns-query'
    - 'https://208.67.220.220/dns-query'
  fallback-filter:
    geoip: true
    ipcidr:
      - 240.0.0.0/4
      - 0.0.0.0/32
      - 127.0.0.1/32
      - 223.75.236.241/32
    domain:
      - +.nfcloud.net
      - +.nfcloud.club
      - +.nfcloud.life
      - +.jsdelivr.net

proxy-groups:
  - name: ğŸŒGlobal
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Global.png
    use:
      - NFcloud
      - 100Mbps
  - name: ğŸ“½ï¸Netflix
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Netflix.png
    proxies:
      - ğŸŒGlobal
    use:
      - NFcloud
  - name: ğŸ“½ï¸YouTube
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/YouTube.png
    proxies:
      - ğŸŒGlobal
    use:
      - NFcloud
  - name: ğŸ“½ï¸Disney+
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Disney+.png
    proxies:
      - ğŸŒGlobal
    use:
      - NFcloud
  - name: ğŸ“½ï¸ForeignMedia
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/ForeignMedia.png
    proxies:
      - ğŸŒGlobal
    use:
      - NFcloud
  - name: âœˆï¸Telegram
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Telegram_X.png
    proxies:
      - ğŸŒGlobal
    use:
      - NFcloud
      - 100Mbps
  - name: ğŸ¤–chatGPT
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Bot.png
    proxies:
      - ğŸŒGlobal
    use:
      - NFcloud
  - name: âœ‰ï¸Mail
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Mail.png
    proxies:
      - ğŸŒGlobal
    use:
      - 100Mbps
  - name: ğŸApple
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Apple_2.png
    proxies:
      - ğŸš€Direct
      - ğŸŒGlobal
  - name: ğŸš€Direct
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Rocket.png
    proxies:
      - DIRECT

proxy-providers:
  NFcloud:
    interval: 86400
    url: https://sub.nfcloud.life/link/2UjkLPlPv9DtSS3T?clash=2
  100Mbps:
    interval: 86400
    url: https://www.100mbps.xyz/subscribe/27/cPXB9dpc0np/clash/

subscribe-url: https://sub.nfcloud.life/link/2UjkLPlPv9DtSS3T?clash=2

rule-providers:
  global:
    behavior: domain
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Global/Global_Domain.yaml
    interval: 86400
  apple:
    behavior: domain
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Apple/Apple_Domain.yaml
    interval: 86400
  netflix:
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Netflix/Netflix.yaml
    interval: 86400
  netflix-ip:
    behavior: ipcidr
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Netflix/Netflix_IP.yaml
    interval: 86400
  youtube:
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/YouTube/YouTube.yaml
    interval: 86400
  openai:
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/OpenAI/OpenAI.yaml
    interval: 86400
  disney:
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Disney/Disney.yaml
    interval: 86400
  foreign-media:
    behavior: domain
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/GlobalMedia/GlobalMedia_Domain.yaml
    interval: 86400
  telegram:
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Telegram/Telegram.yaml
    interval: 86400
  mail:
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Mail/Mail.yaml
    interval: 86400
  china:
    behavior: domain
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/China/China_Domain.yaml
    interval: 86400
  lan-cidr:
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Lan/Lan.yaml
    interval: 86400

rules:
  - RULE-SET,mail,âœ‰ï¸Mail
  - RULE-SET,telegram,âœˆï¸Telegram
  - RULE-SET,netflix,ğŸ“½ï¸Netflix
  - RULE-SET,netflix-ip,ğŸ“½ï¸Netflix
  - RULE-SET,youtube,ğŸ“½ï¸YouTube
  - RULE-SET,disney,ğŸ“½ï¸Disney+
  - RULE-SET,foreign-media,ğŸ“½ï¸ForeignMedia
  - RULE-SET,openai,ğŸ¤–chatGPT
  - RULE-SET,apple,ğŸApple
  - RULE-SET,global,ğŸŒGlobal
  - RULE-SET,china,DIRECT
  - RULE-SET,lan-cidr,DIRECT
  - GEOIP,CN,DIRECT
  - MATCH,ğŸŒGlobal
